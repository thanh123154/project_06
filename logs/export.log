2025-09-15 17:07:34,335 - ERROR - mongo_exporter - Cannot connect to MongoDB: 127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 10.0s, Topology Description: <TopologyDescription id: 68c7e55c0b7ed59f52f5f58d, topology_type: Unknown, servers: [<ServerDescription ('127.0.0.1', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-09-15 17:07:34,335 - ERROR - export_cli - Export failed: 127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 10.0s, Topology Description: <TopologyDescription id: 68c7e55c0b7ed59f52f5f58d, topology_type: Unknown, servers: [<ServerDescription ('127.0.0.1', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-09-15 17:19:04,691 - ERROR - mongo_exporter - Cannot connect to MongoDB: 127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 10.0s, Topology Description: <TopologyDescription id: 68c7e80e02f9f75f73dfe746, topology_type: Unknown, servers: [<ServerDescription ('127.0.0.1', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-09-15 17:19:04,692 - ERROR - export_cli - Export failed: 127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 10.0s, Topology Description: <TopologyDescription id: 68c7e80e02f9f75f73dfe746, topology_type: Unknown, servers: [<ServerDescription ('127.0.0.1', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-09-15 17:19:19,856 - ERROR - mongo_exporter - Cannot connect to MongoDB: Authentication failed., full error: {'ok': 0.0, 'errmsg': 'Authentication failed.', 'code': 18, 'codeName': 'AuthenticationFailed'}
2025-09-15 17:19:19,856 - ERROR - export_cli - Export failed: Authentication failed., full error: {'ok': 0.0, 'errmsg': 'Authentication failed.', 'code': 18, 'codeName': 'AuthenticationFailed'}
2025-09-15 17:19:45,949 - ERROR - mongo_exporter - Cannot connect to MongoDB: 127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 10.0s, Topology Description: <TopologyDescription id: 68c7e837dd0d44096f83f3a9, topology_type: Unknown, servers: [<ServerDescription ('127.0.0.1', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-09-15 17:19:45,950 - ERROR - export_cli - Export failed: 127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 10.0s, Topology Description: <TopologyDescription id: 68c7e837dd0d44096f83f3a9, topology_type: Unknown, servers: [<ServerDescription ('127.0.0.1', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('127.0.0.1:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-09-15 17:21:07,623 - INFO - mongo_exporter - Connected to MongoDB
2025-09-15 17:21:46,851 - INFO - mongo_exporter - Processed 50000 documents...
2025-09-15 17:22:25,385 - INFO - mongo_exporter - Processed 100000 documents...
2025-09-15 17:23:03,513 - INFO - mongo_exporter - Processed 150000 documents...
2025-09-15 17:23:42,767 - INFO - mongo_exporter - Processed 200000 documents...
2025-09-15 17:24:22,677 - INFO - mongo_exporter - Processed 250000 documents...
2025-09-15 17:25:02,594 - INFO - mongo_exporter - Processed 300000 documents...
2025-09-15 17:25:42,975 - INFO - mongo_exporter - Processed 350000 documents...
2025-09-15 17:26:26,504 - INFO - mongo_exporter - Processed 400000 documents...
2025-09-15 17:27:06,198 - INFO - mongo_exporter - Processed 450000 documents...
2025-09-15 17:27:45,735 - INFO - mongo_exporter - Processed 500000 documents...
2025-09-15 17:28:25,746 - INFO - mongo_exporter - Processed 550000 documents...
2025-09-15 17:29:05,472 - INFO - mongo_exporter - Processed 600000 documents...
2025-09-15 17:29:44,720 - INFO - mongo_exporter - Processed 650000 documents...
2025-09-15 17:30:24,022 - INFO - mongo_exporter - Processed 700000 documents...
2025-09-15 17:31:12,662 - INFO - mongo_exporter - Processed 750000 documents...
2025-09-15 17:31:53,051 - INFO - mongo_exporter - Processed 800000 documents...
2025-09-15 17:32:32,173 - INFO - mongo_exporter - Processed 850000 documents...
2025-09-15 17:33:11,291 - INFO - mongo_exporter - Processed 900000 documents...
2025-09-15 17:33:54,731 - INFO - mongo_exporter - Processed 950000 documents...
2025-09-15 17:34:34,295 - INFO - mongo_exporter - Processed 1000000 documents...
2025-09-15 17:35:14,122 - INFO - mongo_exporter - Processed 1050000 documents...
2025-09-15 17:35:53,939 - INFO - mongo_exporter - Processed 1100000 documents...
2025-09-15 17:36:35,870 - INFO - mongo_exporter - Processed 1150000 documents...
2025-09-15 17:37:15,056 - INFO - mongo_exporter - Processed 1200000 documents...
2025-09-15 17:37:54,203 - INFO - mongo_exporter - Processed 1250000 documents...
2025-09-15 17:38:33,472 - INFO - mongo_exporter - Processed 1300000 documents...
2025-09-15 17:39:13,467 - INFO - mongo_exporter - Processed 1350000 documents...
2025-09-15 17:39:52,876 - INFO - mongo_exporter - Processed 1400000 documents...
2025-09-15 17:40:32,389 - INFO - mongo_exporter - Processed 1450000 documents...
2025-09-15 17:41:18,675 - INFO - mongo_exporter - Processed 1500000 documents...
2025-09-15 17:41:58,012 - INFO - mongo_exporter - Processed 1550000 documents...
2025-09-15 17:42:37,196 - INFO - mongo_exporter - Processed 1600000 documents...
2025-09-15 17:43:16,588 - INFO - mongo_exporter - Processed 1650000 documents...
2025-09-15 17:43:56,323 - INFO - mongo_exporter - Processed 1700000 documents...
2025-09-15 17:44:35,724 - INFO - mongo_exporter - Processed 1750000 documents...
2025-09-15 17:45:15,761 - INFO - mongo_exporter - Processed 1800000 documents...
2025-09-15 17:45:55,548 - INFO - mongo_exporter - Processed 1850000 documents...
2025-09-15 17:46:39,493 - INFO - mongo_exporter - Processed 1900000 documents...
2025-09-15 17:47:18,971 - INFO - mongo_exporter - Processed 1950000 documents...
2025-09-15 17:47:58,578 - INFO - mongo_exporter - Processed 2000000 documents...
2025-09-15 17:48:38,009 - INFO - mongo_exporter - Processed 2050000 documents...
2025-09-15 17:49:17,136 - INFO - mongo_exporter - Processed 2100000 documents...
2025-09-15 17:49:56,890 - INFO - mongo_exporter - Processed 2150000 documents...
2025-09-15 17:50:35,592 - INFO - mongo_exporter - Processed 2200000 documents...
2025-09-15 17:51:17,443 - INFO - mongo_exporter - Processed 2250000 documents...
2025-09-15 17:51:57,039 - INFO - mongo_exporter - Processed 2300000 documents...
2025-09-15 17:52:36,047 - INFO - mongo_exporter - Processed 2350000 documents...
2025-09-15 17:53:15,155 - INFO - mongo_exporter - Processed 2400000 documents...
2025-09-15 17:53:54,638 - INFO - mongo_exporter - Processed 2450000 documents...
2025-09-15 17:54:34,138 - INFO - mongo_exporter - Processed 2500000 documents...
2025-09-15 17:55:13,593 - INFO - mongo_exporter - Processed 2550000 documents...
2025-09-15 17:55:53,362 - INFO - mongo_exporter - Processed 2600000 documents...
2025-09-15 17:56:37,144 - INFO - mongo_exporter - Processed 2650000 documents...
2025-09-15 17:57:16,703 - INFO - mongo_exporter - Processed 2700000 documents...
2025-09-15 17:57:56,201 - INFO - mongo_exporter - Processed 2750000 documents...
2025-09-15 17:58:35,549 - INFO - mongo_exporter - Processed 2800000 documents...
2025-09-15 17:59:14,967 - INFO - mongo_exporter - Processed 2850000 documents...
2025-09-15 17:59:54,626 - INFO - mongo_exporter - Processed 2900000 documents...
2025-09-15 18:00:34,040 - INFO - mongo_exporter - Processed 2950000 documents...
2025-09-15 18:01:13,601 - INFO - mongo_exporter - Processed 3000000 documents...
2025-09-15 18:01:56,536 - INFO - mongo_exporter - Processed 3050000 documents...
2025-09-15 18:02:35,916 - INFO - mongo_exporter - Processed 3100000 documents...
2025-09-15 18:03:15,146 - INFO - mongo_exporter - Processed 3150000 documents...
2025-09-15 18:03:55,107 - INFO - mongo_exporter - Processed 3200000 documents...
2025-09-15 18:04:34,954 - INFO - mongo_exporter - Processed 3250000 documents...
2025-09-15 18:05:16,159 - INFO - mongo_exporter - Processed 3300000 documents...
2025-09-15 18:05:55,603 - INFO - mongo_exporter - Processed 3350000 documents...
2025-09-15 18:06:39,854 - INFO - mongo_exporter - Processed 3400000 documents...
2025-09-15 18:07:19,435 - INFO - mongo_exporter - Processed 3450000 documents...
2025-09-15 18:07:58,834 - INFO - mongo_exporter - Processed 3500000 documents...
2025-09-15 18:08:38,253 - INFO - mongo_exporter - Processed 3550000 documents...
2025-09-15 18:09:17,692 - INFO - mongo_exporter - Processed 3600000 documents...
2025-09-15 18:09:57,349 - INFO - mongo_exporter - Processed 3650000 documents...
2025-09-15 18:10:36,978 - INFO - mongo_exporter - Processed 3700000 documents...
2025-09-15 18:11:16,549 - INFO - mongo_exporter - Processed 3750000 documents...
2025-09-15 18:11:59,471 - INFO - mongo_exporter - Processed 3800000 documents...
2025-09-15 18:12:38,771 - INFO - mongo_exporter - Processed 3850000 documents...
2025-09-15 18:13:18,524 - INFO - mongo_exporter - Processed 3900000 documents...
2025-09-15 18:13:58,818 - INFO - mongo_exporter - Processed 3950000 documents...
2025-09-15 18:14:38,788 - INFO - mongo_exporter - Processed 4000000 documents...
2025-09-15 18:15:18,152 - INFO - mongo_exporter - Processed 4050000 documents...
2025-09-15 18:15:57,292 - INFO - mongo_exporter - Processed 4100000 documents...
2025-09-15 18:16:37,190 - INFO - mongo_exporter - Processed 4150000 documents...
2025-09-15 18:17:19,373 - INFO - mongo_exporter - Processed 4200000 documents...
2025-09-15 18:17:58,901 - INFO - mongo_exporter - Processed 4250000 documents...
2025-09-15 18:18:38,036 - INFO - mongo_exporter - Processed 4300000 documents...
2025-09-15 18:19:17,586 - INFO - mongo_exporter - Processed 4350000 documents...
2025-09-15 18:19:57,241 - INFO - mongo_exporter - Processed 4400000 documents...
2025-09-15 18:20:36,219 - INFO - mongo_exporter - Processed 4450000 documents...
2025-09-15 18:21:15,819 - INFO - mongo_exporter - Processed 4500000 documents...
2025-09-15 18:21:58,643 - INFO - mongo_exporter - Processed 4550000 documents...
2025-09-15 18:22:37,970 - INFO - mongo_exporter - Processed 4600000 documents...
2025-09-15 18:23:17,311 - INFO - mongo_exporter - Processed 4650000 documents...
2025-09-15 18:23:56,429 - INFO - mongo_exporter - Processed 4700000 documents...
2025-09-15 18:24:35,675 - INFO - mongo_exporter - Processed 4750000 documents...
2025-09-15 18:25:14,814 - INFO - mongo_exporter - Processed 4800000 documents...
2025-09-15 18:25:54,122 - INFO - mongo_exporter - Processed 4850000 documents...
2025-09-15 18:26:33,561 - INFO - mongo_exporter - Processed 4900000 documents...
2025-09-15 18:27:18,772 - INFO - mongo_exporter - Processed 4950000 documents...
2025-09-15 18:27:57,799 - INFO - mongo_exporter - Processed 5000000 documents...
2025-09-15 18:28:37,096 - INFO - mongo_exporter - Processed 5050000 documents...
2025-09-15 18:29:16,464 - INFO - mongo_exporter - Processed 5100000 documents...
2025-09-15 18:29:55,588 - INFO - mongo_exporter - Processed 5150000 documents...
2025-09-15 18:30:34,905 - INFO - mongo_exporter - Processed 5200000 documents...
2025-09-15 18:31:14,736 - INFO - mongo_exporter - Processed 5250000 documents...
2025-09-15 18:31:56,037 - INFO - mongo_exporter - Processed 5300000 documents...
2025-09-15 18:32:37,262 - INFO - mongo_exporter - Processed 5350000 documents...
2025-09-15 18:33:17,665 - INFO - mongo_exporter - Processed 5400000 documents...
2025-09-15 18:33:56,877 - INFO - mongo_exporter - Processed 5450000 documents...
2025-09-15 18:34:35,894 - INFO - mongo_exporter - Processed 5500000 documents...
2025-09-15 18:35:15,236 - INFO - mongo_exporter - Processed 5550000 documents...
2025-09-15 18:35:54,842 - INFO - mongo_exporter - Processed 5600000 documents...
2025-09-15 18:36:34,251 - INFO - mongo_exporter - Processed 5650000 documents...
2025-09-15 18:37:13,908 - INFO - mongo_exporter - Processed 5700000 documents...
2025-09-15 18:37:53,424 - INFO - mongo_exporter - Processed 5750000 documents...
2025-09-15 18:38:33,052 - INFO - mongo_exporter - Processed 5800000 documents...
2025-09-15 18:39:11,885 - INFO - mongo_exporter - Processed 5850000 documents...
2025-09-15 23:00:38,995 - ERROR - mongo_exporter - Export failed after 5895000 docs: 127.0.0.1:27018: connection closed (configured timeouts: connectTimeoutMS: 20000.0ms)
Traceback (most recent call last):
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/pool.py", line 505, in receive_message
    return receive_message(self, request_id, self.max_message_size)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/network_layer.py", line 677, in receive_message
    data = receive_data(conn, length - 16, deadline)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/network_layer.py", line 160, in receive_data
    raise OSError("connection closed")
OSError: connection closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/exporter/mongo_exporter.py", line 59, in export
    for doc in cursor:
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/cursor.py", line 1289, in __next__
    return self.next()
           ^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/cursor.py", line 1265, in next
    if len(self._data) or self._refresh():
                          ^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/cursor.py", line 1236, in _refresh
    self._send_message(g)
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/cursor.py", line 1108, in _send_message
    response = client._run_operation(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/_csot.py", line 125, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 1938, in _run_operation
    return self._retryable_read(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 2047, in _retryable_read
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/_csot.py", line 125, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 2014, in _retry_internal
    ).run()
      ^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 2765, in run
    return self._read() if self._is_read else self._write()
           ^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 2926, in _read
    return self._func(self._session, self._server, conn, read_pref)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/mongo_client.py", line 1929, in _cmd
    return server.run_operation(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/helpers.py", line 47, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/server.py", line 208, in run_operation
    reply = conn.receive_message(request_id)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/pool.py", line 508, in receive_message
    self._raise_connection_failure(error)
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/synchronous/pool.py", line 662, in _raise_connection_failure
    _raise_connection_failure(self.address, error, timeout_details=details)
  File "/home/nguyen-xuan-thanh/work/project_06/project_06/.venv/lib/python3.12/site-packages/pymongo/pool_shared.py", line 152, in _raise_connection_failure
    raise AutoReconnect(msg) from error
pymongo.errors.AutoReconnect: 127.0.0.1:27018: connection closed (configured timeouts: connectTimeoutMS: 20000.0ms)
2025-09-15 23:00:38,997 - ERROR - export_cli - Export failed: 127.0.0.1:27018: connection closed (configured timeouts: connectTimeoutMS: 20000.0ms)
